## Обо мне
Привет! Меня зовут Юра Ткаченко
Я занимаюсь фронтенд разроботкой уже больше 12 лет.

И признаться, до сих пор засиживаюсь по ночам или выходным,
чтобы не потерять темп.

## Технологии бегут как ужаленые
Потому что в разработке, а тем более фронтенда,
если ты не бежишь, то считай стоишь на месте.

То, что вчера было мейнстримом, сегодня — это устаревшая ерунда.
Даже если знания вашей текущей инфраструтктуры, библиотек и инструментов
полностью удовлетворяют требования вашего проекта и вы не хотите ничего менять — это не повод не изучать новое.

И я расскажу почему.

## История
Мы все помним каким был фронтенд 15 лет назад.
Хотя что-то я погорячился, таких мамонтов как я, в зале раз-два и все :)

## Каким был JavaScript
Таким.
Снежинки — вот что он делал.

Сделать что-то более серьезное не позволяло множество факторов:

* прежде всего разная интерпретация языка в разных браузерах
* медленные компьютеры и медленные интерпритаторы
* бедное html api

И вообще тогда даже эра CSS только начиналась

## Каким был CSS
CSS почти не было, в пузырь доткомов и долгое время после сайты были вообще без стилей, все оформление описывалось прямо в HTML, ну вы в курсе, если и не застали этой поры. Потом еще модным было понятие DHTML — я до сих пор не знаю что это такое :)

### Борьба за CSS
В начале 2000-х пошла волна про разделение оформления и структуры документа.
Тогда в эту игру активно вступили бразуеры и начали соревноваться в поддержке CSS.

Появился ACID2, такой нашумевший проект как css zen-garden — вообщем хайпа в те времена хватало и не сказать что было меньше чем сейчас.

## Эра JavaScript
Когда с CSS все начало выравниваться и верстать таблицами стало уж совсем моветон,
в игру всупает javascript как единственный **дейтсвительно работающий** язык программирования, доступный на клиенте.

## Фронтенд разработка становится профессией
И тут, на мой взгляд, случается переломный момент — технология развивается крайне стремительно, разработка фронтенда начинает становится серьезной профессией, чувствуется нехватка разработчиков, зарплаты растут очень быстро

## Появляется инфраструктура
И, главное, собственно о чем мы будем говорить — развивается инфраструктура.

## jQuery, Node.JS, Github и сборка
Выходит jQuery и плагины растут как грибы после дождя, с поддержкой history API и локальных хранилищ начинют появляться Single Page Application.

И под занавес появляются Node.JS, веб-сервер express и куча утилит для сборки фронтенда, написанных на js.

Теперь становится все по взрослому и серьезно — фронтенд крупных продуктов такой же сложный как и бекенд и над ним трудится зачастую больше людей.

## Промежуточный итог
Ладно, хватит тут трясти песком, давайте подобьем что у нас сейчас есть.
Итак мы пережили ряд толчков, которые сильно повлияли на индустрию:

* поддержка CSS3
* jQuery
* гонка js-движков, повяляется V8
* node.js
* MVC-фреймворки
* и сейчас виртуальный дом и React

## «1. Прогресс неостановим; 2. Работать все равно ничего не будет» — Илья Сегалович
Сейчас события, которые обычно занимали несколько лет проходят за несколько месяцев:

Новые версии ECMA Script и стандарты HTML открывают соверженно безграницные возможности.
Даже когда браузеры не успевают за спецификацией, появляются транспайлеры из новых версий языка в es5 — самый крутой и популярный Babel.
Это сильно упрощает ежедневную работу, но добавляет новое звено в сборку проекта.

## Отказ от jQuery
Все больше проектов откзываются от jq, основная цель которого была стандартизировать апи браузера, теперь это случилось и нужды в jQuery все меньше и меньше с каждым днем.

## Бум MVC
Мы очень быстро пережили (я надеюсь пережили) бум MVC фреймворков: knockout, backbone, angular..
Теперь MVC не очень модно и все любят Flux.

## Вымирает профессия верстальщика
Я — верстальщик. Я очень много занимался CSS и в мир JS пришел весьма поздно. Но как бы моя ностальгия ни была сильна, нужно признать что CSS теперь вообще not a big deal.
И он занимает ровно свою нишу — способ разукрасить страницу.

Безусловно CSS богат и очень мощный способ оформлять страницу, на него сейчас можно перенести очено много всего, что по инерции часто делается на JS.
Но тем не менее сегодня он перстал быть магией, потому что не нужно больше понимать как CSS работает в разных браузерах — он везде работает одинаково.

## Модульность
Все сейчас модульно. И если, например, BEМ проповедует это очень давно и выстроил некотурую стабильную инфраструктуру вокруг этого, то весь остальной мир только пришел к этому.

Мы имеем множество сборщиков: grunt, gulp, webpack каждый из которых так или иначе умеет делать live reload приложения при измении контента.

Появились пакетные менеджеры: bower, npm
и неограниченный источник компонент на github

* js -- язык номер 1 и на треть опрежеает ближайшего сопреника Java на гитхабе)
* css — четвертый

Генераторы проектов, от фулстека до очень специфических — все есть, все готово, бери и собирай свою инфраструктуру и пиши бизнес-логику.

## Прогресс не остановим
Итак, чуть более чем 10 лет назад у нас был один CSS файл и js-файл со снежинками
Сегодня у нас каждое сохранение обрабатывает маленький локальный сервер с live-reload, валидируется и пересобирается js и css.

А на каждый пуш в репозиторий мы запускаем тесты, дженкинс или тимсити собирает на проект и автодеплоит его в тестовое окружение.

## Работать все равно ничего не будет
Казалось бы — что может пойти не так?
Ответ — примерно всё.

## Что может пойти не так

## Fuck Enterprise
Сегодня вы не начинаете следующий проект таким же образом как начинали предыдущий.
Как минимум вы постарайтесь _добавить_ что-то новенькое и обновить основные библиотеки.

Но вероятно это будет абсолютно новый стек технологий.

Вчера это был бы Node.js 0.12 + Express.js + Angular + SASS/Stylus/Autoprefixer
Сегодня это уже Node.js 4.0.0 (с вмердженным уже io.js) + возможно hapi.js + React.js + набор PostCSS плагинов.
Разница между стеками — пол года!
Ни капли стабильности.

## Что может пойти не так

### Опенсорс

#### Разработчики теряют интерес
Разработчики бросают свои проекты, а у вас на них завязан свой: вы вынуждены переезжать или делать и поддерживать форк, или брать роль мейнтейнера.

Stylus бы окончательно умер, если бы не мои бывшие коллеги Рома Комаров и Миша Корепанов, которые развивают проект.

А сколько таких библиотек?

#### Закрывают проект в пользу конкуртента
Сейчас на github 1500 deprecated javascript репозиториев.
А вам переезжать может быть очень дорого, но это прийдется сделать иначе библиотека сломается при обновлении других зависимостей или окружения.

#### Соместимость? Не не слышал.
Библиотека не работает с вашей ужасно устаревшей node.js 0.12? Переходите на io.js или Node.js 4.0 никакого автора не волнует, что там не будут работать все остальные ваши библиотеки.

Вполне нормальная история, если у вас node.js 0.10 например в продакшене то скоро множество библиотек вы не сможете использовать. А фичи новые нужны.

Обновиться же до новых версий — целое дело. Нужно быть уверенным что все библиотеки обновились и работают нормально в новом окружении.

Буквально пока я пишу этот доклад, Дэн Абрамов выпускает новую версию React Router с ломающими обратную совместимость изменениями:
https://twitter.com/dan_abramov/status/643125000103444480

Очень в руку к этому докладу кстати выша новая версия node.js
https://twitter.com/twenty/status/641507269876838400
https://github.com/socketio/socket.io/issues/2228

### Что еще сломается?

#### пакетные менеджеры и репозитории
Самое распространное — недоступность репозитория или менеджера пакетов.
Тут и банальный 'guthub опять лег' и проблемы с настройками сети на билд машинах.

Все знают эту картинку: [github unicorn].

А у вас деплой :) Даже если вы перестраховались и храните код проекта в своем гите, но при сборке выполняете bower/npm install — все, вы под прицелом.

#### конфликты библиотек
Раньше самое болезненное было расширение прототипов встроенных js классов абы как.
Например, прототип массива расшири чем-то идиотским, потом с таким же названием появился стандартный метод и все — он у вас не работает как нужно.
Я лично встречал переопределенный Array.prototype.filter

Или же несколько jquery-like библиотек просто потому что одна уже была и выпилиивать ее страшно, потом пришел разработчик, который очевидно не собирается на таком старье писать и добавил jquery.

#### Кратко другие больные места

##### разные версии опреционок или node.js в разработке и на сервере сборки или на тестинге/продакшене

Билд свалится или код работать не будет, хуже если будет но не так и вы сразу не заметите

##### Разные версии одной библиотеки в проекте
если все работает хорошо в CLI то это не проблема, даже на сервере это как правило не такая большая проблема, но такая сборка часто попадает на клиент просто из-за невнимательности или зависимостей third-party библиотек, а вы и знать этого не будете.

##### Обновление библиотек
Обновление одной библиотеки часто требует обновление других. И не всегда это омжно заметить сразу.

## Опять промежуточный итог
Все что я перечислил (а это далеко не все проблемы) — это не плохо, это так развивается и растет организм фронтенд-разработки, сейчас у него юношеский период, он пробует алкоголь и наркотики, его музыкальные вкусы меняются пару раз в день, будущее для него видится с радугами и розовыми пони.

Все хорошо, мы растем, так и должно быть.

## Но очевидный вопрос «Что делать?»
Конечно нет готового решения, как предоствартить эти и еще кучу не описанных проблем, которые сегодня появляются при сборке, деплое и в продакшене фронтенда.

Но есть несколько хороших практик, которые помогут избежать головной боли или хотя бы начать реагировать как можно быстрее.

### Обязательно

1. Хранить библиотеки в репозитории: да, комитеть node_modules и bower_components в репозиторий. Не ндейтесь что npm и github будут всегда доступны.
2. Хранить сборки проекта, если вы выктились в продакшн с ошибками, у вас всегда должна быть под рукой предыдущая сборка — не просто тег в репозитории, а готовый собранный пакет, чтобы вы могли в любой момент откатиться на предудщую версию.
3. Jenkins или TeamCity помогут вам настроить сборку на каждый пуш в релизную ветку, таким образом вы всегда будете знать, что хотя бы сборка прошла хорошо. В идеале Сразу после этого должен быть деплой в тестовое окружение.

### Общие рекомендации
1. Следить за библиотеками и обновлять их как можно быстрее. Тестировать бета версии и внедрять стабильные. К сожалению это болезненно, так как требует хорошоего покрытия тестами, а покрывать фронтенд тестами не так уж легко и не всегда на этого хватает бюджетов.
2. Вычищать мертвеющие библиотеки: конечно еще более тяжело, если вдруг вся архитектура вашего приложения строится на уходящией в забвение библиотеке — переехать целое дело. Но как только вы видите что это происходит нужно начать готовить почву для переезда. Иначе потом будет сильно больнее, когда варианта непереезжать не останется
3. Stop using bower, я не буду останавливаться на всех недостатках bower в сравнении с npm, про это есть множество статей. Самое очевидное: не стоит использовать 2 разных менеджера зависимостей.
4. Вводите практитки в компании: code review и code style — две головы лучше.


### Для  повышения стабильности
1. npm-shrinkwrap: зафиксирует версии пакетов по всему дереву зависимостей: убедитесь, что у вас все работает как надо, сделайте npm-shrinkwrap и добавьте сгенерированный npm-shrinkwrap.json в ваше приложение. Далее при npm i вы будете использовать конкртеное дерево пакетов
2. Монитрьте window.performance метрики и обшибки на клиенте, чтобы понимать что происходит и настройте оповещения на случай если что-то идет не так, для этого есть инструменты такие как New Relic или Sentry. Проблемы могут быть не у вас, а нпример, отвалился CDN который вы используете для получения популярной библиотеки.
Хотя бы настройте Яндекс.Метрику или Гугл аналитику.
3. Автоматическое тестирование дерадации скорости. Это сложно, но возможно.
4. A/B тесты: деплой новой версии на маленький % пользователей.

Как я уже говорил все это все равно не даст вам 100% увереннсти и гарантии, но эти правила, как говорят, получены "потом и кровью" — чем больше проект, тем больше этих правил нужно использовать.

## Не бойтесь изобретать
Когда вы сталкивайтесь с проблемой и не находите готово решения — делайте свое и делитесь с миром, уверен, что найдутся многие, кто скажут вам спасибо.

А сейчас за то, что терпели меня, говорю спасибо я — вы прекрасная аудиторя.

Вопросы?

